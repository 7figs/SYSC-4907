{% extends "base.html" %}
{% block title %}Dislike Selection{% endblock %}
{% block links %}
    <link rel="stylesheet" href="../static/css/cold_start.css">
{% endblock %}
{% block content %}
    <div class="cold-start-container">
        <h1>Which of these movies do you dislike?</h1>
        <p>Pick movies you don't like from this random set</p>

        <form id="dislikeForm">
            <div id="dislikesGrid" class="movies-grid">
                <!-- JS will populate random movie cards here -->
            </div>

            <div style="display:flex;gap:12px;justify-content:center;margin-top:16px">
                <button type = "button" id = "backBtn" class = "back-btn">Back</button>
                <button type="submit" class="submit-btn">Save Dislikes & Finish</button>
            </div>
        </form>
    </div>

    <script>
        //We will need to sample a random set of movies from a master list and display them here (this is just a starting point)
        const MASTER_MOVIES = [
            { title: "The Shawshank Redemption", img: "../static/images/Shawshank.jpg" },
            { title: "The Godfather", img: "../static/images/Godfather.jpg" },
            { title: "Inception", img: "../static/images/Inception.jpg" },
            { title: "The Dark Knight", img: "../static/images/DarkKnight.jpg" },
            { title: "Pulp Fiction", img: "../static/images/Pulpfiction.jpg" },
            { title: "Forrest Gump", img: "../static/images/ForestGump.jpg" },
            { title: "Fight Club", img: "../static/images/fightclub.jpg" },
            { title: "The Matrix", img: "../static/images/TheMatrix.png" },
            { title: "Interstellar", img: "../static/images/Interstellar.jpg" },
            { title: "The Lord of the Rings: The Fellowship of the Ring", img: "../static/images/lotrfotr.jpg" }
        ];

        function sampleMovies(count = 10) {
            const pool = MASTER_MOVIES.slice();
            for (let i = pool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [pool[i], pool[j]] = [pool[j], pool[i]];
            }
            return pool.slice(0, Math.min(count, pool.length));
        }

        function createCard(movie) {
            const label = document.createElement('label');
            label.className = 'movie-item';
            label.style.flexDirection = 'column';
            label.innerHTML = `
                <img src="${movie.img}" alt="${movie.title}">
                <div style="display:flex;align-items:center;gap:8px;margin-top:8px">
                    <input type="checkbox" name="dislikes" value="${movie.title}">
                    <span>${movie.title}</span>
                </div>
            `;
            return label;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const grid = document.getElementById('dislikesGrid');
            const sample = sampleMovies(10);
            sample.forEach(m => grid.appendChild(createCard(m)));

            const backBtn = document.getElementById('backBtn');
            if (backBtn) {
                backBtn.addEventListener('click', () => {
                    window.location.href = '/start';
                });
            }

            const form = document.getElementById('dislikeForm');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    // No JSON/localStorage saving â€” just finish flow
                    window.location.href = '/choose_account';
                });
            }
        });
    </script>
{% endblock %}